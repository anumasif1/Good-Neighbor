{{!-- <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="/" id="macmac">Good Neighbor</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
        aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarText">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" style="color: green">Welcome: {{ username }}</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/logout" style="color: red">Logout</a>
            </li>
        </ul>
        <span class="navbar-text" style="text-decoration: underline;">
            I will be collapsed~
        </span>
    </div>
</nav> --}}
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" style="color: green">Welcome: {{ username }}</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/logout" style="color: red">Logout</a>
        </li>
    </ul>
</nav>

{{!-- <div style="background-color:rgb(217, 217, 247);"> --}}
<div class="container-fluid" style="margin-top: 0px;">

    <div class="card bg-light mb-2 mt-5 mx-auto"
        style="max-width: 50rem; background-color:rgb(217, 217, 247) !important; border-style: none;">
        <!-- PART 1&2 -->
        <div class="card mb-3">
            <!-- ​create post -->
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-seller" role="tabpanel" aria-labelledby="nav-seller-tab">
                    <div class="container mx-auto mt-3">
                        <form>
                            <div class="form-group">
                                <label for="postContent">Create Post </label>
                                <textarea type="text" class="form-control" id="inputnewpost" rows="3"
                                    placeholder="Make a new post..." name="namenewpost"></textarea>
                            </div>
                            <div class="mb-2 float-right">
                                <button type="submit" class="btn btn-outline-success" id="submitnewpost">Submit</button>
                            </div>
                        </form>

                    </div>
                </div>
                <!-- ​map show -->
                <div class="tab-pane fade" id="nav-buyer" role="tabpanel" aria-labelledby="nav-buyer-tab">
                    <div class="container mx-auto mt-3">
                        <form>
                            <div class="form-group">
                                <label for="exampleFormControlTextarea1"><b>Create Post</b></label>
                                <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"
                                    placeholder="What are you looking for?"></textarea>
                            </div>
                        </form>
                        <div class="mb-2 float-right">
                            <button type="button" class="btn btn-outline-success" id="submit-post">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ​PART 3 -->
        <!-- newpost page -->
        <div class="container p-0">
            <div class="col-md-12">
                <div class="row mb-2">
                    <div id="mapid"></div>

                </div>

                <div class="row">
                    <div class="card bg-light mb-3" style="width: 100%;">
                        <div class="card-header">Posts</div>
                        ​

                        <div class="card-body">
                            <div class="container" style="padding: 20px;">

                                <ul id="ulComment">
                                    {{#each allPost }}
                                    <nav>
                                        <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                            <li>
                                                <a style="color: green;">{{this.user.name}}
                                                    < {{formatTime this.createdAt "MM-DD-YYYY hh:mm"}}></a>
                                            </li>
                                        </div>
                                    </nav>
                                    <!-- postview -->
                                    <div class="tab-content" id="nav-tabContent">
                                        <a style="font-size: 30px;">{{this.member_post}}</a>

                                        ​
                                    </div>
                                    <form>
                                        <div class="form-group">
                                            {{!-- <label for="commentContent">: </label> --}}
                                            <input type="text" data-inputcomment="{{this.id}}"
                                                class="form-control inputclass" placeholder="Make new comment here"
                                                name="namenewcomment"></textarea>
                                        </div>
                                        <button type="submit" class="subcomment btn btn-outline-success"
                                            onclick="executeJS(this)" data-submitcomment="{{this.id}}">Submit</button>
                                    </form>
                                    <div class="container pl-0 pr-0">
                                        ​
                                        <button type="button" class="btn btn-light mt-3 active btn-block"
                                            data-toggle="collapse" data-target="#demo">
                                            <div class="glyphicon glyphicon-collapse-down"></div> Comments
                                        </button>
                                        ​
                                        <div class="row ml-0 mr-0">
                                            <div id="demo" class="collapse" style="width: 100%;">
                                                <div class="card bg-light mb-3">
                                                    <div class="card-body">
                                                        {{!-- SHOW COMMENT --}}
                                                        {{!-- <div style="margin-top: 20px; margin-bottom: 10px;">Comment:
                                                        </div> --}}
                                                        <ul style="">

                                                            {{#each ../allComment}}
                                                            {{#if_eq this.postId ../this.id}}
                                                            <li style="list-style-type:circle;">
                                                                <a style="color: grey">{{this.member_comment}};
                                                                    {{this.member_name}} <
                                                                        {{formatTime this.createdAt "MM-DD-YYYY hh:mm"}}>
                                                                </a>
                                                            </li>
                                                            {{/if_eq}}
                                                            {{/each}}
                                                        </ul>




                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    ​ {{/each}}
                                </ul>
                            </div>
                        </div>
                        ​
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{!-- </div> --}}
<br><br>

<script src="/mapjs/"></script>
<script>
    $(document).on("click", "#submitnewpost", (event) => {
        event.preventDefault();

        var newPost = {
            member_post: $("#inputnewpost").val().trim()
        };
        $.ajax("/success/post", {
            type: "POST",
            data: newPost
        }).then(() => {
            location.reload();
        });
    })

    function executeJS(element) {
        var id = $(element).data('submitcomment');
        var member_comment = $("#ulComment [data-inputcomment=" + id + "]").val().trim();
        console.log(id);
        var newComment = {
            postId: id,
            member_comment: member_comment
        };
        //alert(id + "  $$  " + newComment.member_comment)
        $.ajax("/success/comment", {
            type: "POST",
            data: newComment
        }).then(() => {
            // location.reload();
        })

    }
</script>